@model IEnumerable<HospitalSystem.Models.Admin>

@{
    ViewBag.Title = "Admin Management";
}

@Html.Partial("~/Views/Admins/Header.cshtml")


<section id="doktor-yonetimi">
    <div class="container">
        <h2 style="display:inline">Admin Management</h2>
        <div class="addButton">
            @Html.ActionLink("Add Admin", "Create", null, new { @class = "addButtonInside" })
        </div>
        <div class="bosluk"> </div>
        <ul class="responsive-table">
            <li class="table-header">
                <div class="col col-1">@Html.DisplayNameFor(model => model.UserId)</div>
                <div class="col col-1">Role</div>
                <div class="col col-2">@Html.DisplayNameFor(model => model.Email)</div>
                <div class="col col-4">Actions</div>
            </li>
            @foreach (var item in Model)
            {
                <li class="table-row">
                    <div class="col col-1" data-label="Job Id">@Html.DisplayFor(modelItem => item.UserId).ToString().Substring(0,8)</div>
                    <div class="col col-1" data-label="Job Id">
                        @if (item.Accountant)
                        {
                            @Html.Raw("Accountant")
                        }
                        else
                        {
                            @Html.Raw("Admin")
                        }

                    </div>
                    <div class="col col-2" data-label="Doctor Name">@Html.DisplayFor(modelItem => item.Email)</div>
                    <div class="col col-4" data-label="Operation">
                        @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                        @Html.ActionLink("Details", "Details", new { id = item.Id }, new { @class = "getDetails" }) |
                        @if (item.Id != 1)
                        {
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id }, new { @class = "delete" });
                        }
                        else
                        {
                            @Html.Raw("Can't be deleted")
                        }
                    </div>
                </li>
            }
        </ul>
    </div>


</section>



<div id="ex1" class="modal" style="max-width:initial">
    <section id="ozel-sayfa" style="padding:0;margin-bottom:0">
        <div class="container" style="max-width:initial">
            <div class="kisisel-bilgiler">
                <h3>Personal Information</h3>
                <ul>
                    <li class="adminUserId"><span>User Id:</span> </li>
                    <li class="adminDoB"><span>Date of Birth:</span> </li>
                    <li class="adminNumber"><span>Phone Number:</span> </li>
                    <li class="adminEmail"><span>E-Mail Address:</span></li>
                   
                </ul>
            </div>
            <div class="hesap-bilgileri">
                <h3>-</h3>
                <ul>
                    <li class="adminAccountant"><span>Experience:</span></li>
                    <li class="adminAddress"><span>Specializations:</span> </li>
                    <li class="adminCity"><span>Langs:</span></li>
                </ul>
            </div>
        </div>
    </section>
</div>


<script>
     function gettoken() {
        var token = '@Html.AntiForgeryToken()';
        token = $(token).val();
        return token;
    }


    $('.delete').click(function (event) {//linke click eventi kazandırma
        event.preventDefault();
        if (confirm("Do you sure delete this admin")) {
            $.ajax({
                url: this.href,
                data: {
                    __RequestVerificationToken: gettoken()
                },
                type: 'POST',
                success: function (result) {
                    location.reload();
                }
            });
        }

    });
       //hasta tarafı
    $('.getDetails').click(function (event) {//linke click eventi kazandırma
        event.preventDefault();
        this.blur();
        $.get(this.href, function (json) {
            const admin = JSON.parse(json)
            $('li.adminUserId').html('<span>User:</span> ' + admin.UserId)
            $('li.adminDoB').html('<span>Date of Birth:</span> ' +(new Date(admin.DOB)).toLocaleDateString())
            $('li.adminNumber').html('<span>Phone Number:</span> ' + admin.PhoneNumber)
            $('li.adminEmail').html('<span>Email:</span> ' + admin.Email) 
            $('li.adminCity').html('<span>City:</span> ' + admin.City)
            $('li.adminAccountant').html('<span>Accountant:</span> ' +  (admin.Accountant?"Yes":"No"))
            $('li.adminAddress').html('<span>Address:</span> ' + admin.Address)
            $('#ex1').modal();
        });
    });

       //hasta tarafı

</script>

